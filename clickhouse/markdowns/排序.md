## order by

### basic

```
ORDER BY Visits DESC, SearchPhrase.
```

### NaN or null
```
SELECT * FROM t_null_nan ORDER BY y NULLS/NaN FIRST
```

### Collation && comparison

```
ORDER BY SearchPhrase COLLATE 'tr'
SELECT * FROM collate_test ORDER BY s ASC COLLATE 'en'; 
```

### Limit 

### ASC & DESC

### optimize_read_in_order

When the optimize_read_in_order setting is disabled, the ClickHouse server does not use the table index while processing SELECT queries. Default enabled.

Optimization is supported in the following table engines:

- MergeTree
- Merge, Buffer, and MaterializedView table engines over MergeTree-engine tables

In MaterializedView-engine tables the optimization works with views like SELECT ... FROM merge_tree_table ORDER BY pk. But it is not supported in the queries like SELECT ... FROM view ORDER BY pk if the view query does not have the ORDER BY clause.

### ORDER BY Expr WITH FILL Modifier

```
ORDER BY expr [WITH FILL] [FROM const_expr] [TO const_expr] [STEP const_numeric_expr], ... exprN [WITH FILL] [FROM expr] [TO expr] [STEP numeric_expr]
[INTERPOLATE [(col [AS expr], ... colN [AS exprN])]]
```

i.e：
```
SELECT n, source FROM (
   SELECT toFloat32(number % 10) AS n, 'original' AS source
   FROM numbers(10) WHERE number % 3 = 1
) ORDER BY n WITH FILL FROM 0 TO 5.51 STEP 0.5;
```

### To optimize the order by 

https://www.cnblogs.com/niutao/articles/15313070.html : 

- ReplicatedAggregatingMergeTree (按照块来做归并排序)
- union all （按照月切分）

## group by

#### GROUP BY Optimization Depending on Table Sorting Key

optimize_aggregation_in_order

Possible values:

0 — GROUP BY optimization is disabled.
1 — GROUP BY optimization is enabled.
Default value: 0.

#### GROUP BY in External Memory

max_bytes_before_external_group_by =  max_memory_usage / 2

If you have an ORDER BY with a LIMIT after GROUP BY, then the amount of used RAM depends on the amount of data in LIMIT, not in the whole table. But if the ORDER BY does not have LIMIT, do not forget to enable external sorting (max_bytes_before_external_sort).